import matplotlib.pyplot as plt

# =========================
# Input data
# =========================
m = [
    10, 272, 535, 797, 1060, 1323, 1585, 1848, 2111, 2373,
    2636, 2898, 3161, 3424, 3686, 3949, 4212, 4474, 4737, 5000
]

assembly_time_gpu = [
    0.004756927490234375,
    0.0008838176727294922,
    0.0013849735260009766,
    0.0015993118286132812,
    0.0016639232635498047,
    0.0019805431365966797,
    0.002526521682739258,
    0.003499269485473633,
    0.0042607784271240234,
    0.005242824554443359,
    0.0064165592193603516,
    0.007802724838256836,
    0.00902700424194336,
    0.010329008102416992,
    0.012947320938110352,
    0.01391458511352539,
    0.015003204345703125,
    0.016818761825561523,
    0.018878698348999023,
    0.020768165588378906,
]

solve_time_gpu = [
    0.07759356498718262,
    0.09886312484741211,
    0.06090664863586426,
    0.06047964096069336,
    0.06093883514404297,
    0.06989049911499023,
    0.0965876579284668,
    0.11901235580444336,
    0.14225220680236816,
    0.16341757774353027,
    0.19155097007751465,
    0.22282695770263672,
    0.22907495498657227,
    0.2694072723388672,
    0.3312814235687256,
    0.33597564697265625,
    0.3583981990814209,
    0.3935115337371826,
    0.4363408088684082,
    0.4831070899963379,
]

total_time = [
    0.0770371913909912,
    0.10092473030090332,
    0.0728602409362793,
    0.06577920913696289,
    0.06802082061767578,
    0.08051419258117676,
    0.10943865776062012,
    0.13782167434692383,
    0.16463422775268555,
    0.191009521484375,
    0.22613859176635742,
    0.26322412490844727,
    0.27733898162841797,
    0.3271291255950928,
    0.41018128395080566,
    0.4262197017669678,
    0.44706177711486816,
    0.4973158836364746,
    0.5563375949859619,
    0.6201822757720947,
]

# =========================
# Plot
# =========================
plt.figure(figsize=(8, 5))

plt.plot(m, assembly_time_gpu, marker='o', label='Assembly time (GPU)')
plt.plot(m, solve_time_gpu,    marker='o', label='Solve time (GPU)')
plt.plot(m, total_time,        marker='o', label='Total time')

plt.xlabel('Number of elements (m)')
plt.ylabel('Time (seconds)')
plt.title('GPU FEM Timing vs Spatial Resolution')
plt.legend()
plt.grid(True)

plt.tight_layout()
plt.show()
