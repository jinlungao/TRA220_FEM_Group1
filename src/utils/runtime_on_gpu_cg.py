import matplotlib.pyplot as plt

# x-axis
m = [
    10, 272, 535, 797, 1060, 1323, 1585, 1848, 2111, 2373,
    2636, 2898, 3161, 3424, 3686, 3949, 4212, 4474, 4737, 5000
]

# y-series
assembly_time_gpu = [
    0.09803962707519531,
    0.012684106826782227,
    0.01157069206237793,
    0.002839803695678711,
    0.011392593383789062,
    0.002757549285888672,
    0.0027844905853271484,
    0.0030744075775146484,
    0.0029892921447753906,
    0.002957582473754883,
    0.003200054168701172,
    0.0029401779174804688,
    0.0029931068420410156,
    0.003268003463745117,
    0.003105640411376953,
    0.0028884410858154297,
    0.002933025360107422,
    0.002939939498901367,
    0.0030565261840820312,
    0.0032804012298583984
]

solve_time_gpu = [
    0.7520537376403809,
    0.7254548072814941,
    0.4453134536743164,
    0.5359034538269043,
    0.7818088531494141,
    1.030911922454834,
    1.2055728435516357,
    1.5208730697631836,
    1.7658684253692627,
    2.0086934566497803,
    2.218470573425293,
    2.4597818851470947,
    2.6583433151245117,
    2.9061856269836426,
    3.073814868927002,
    3.2141478061676025,
    3.492224931716919,
    3.6340930461883545,
    3.8207218647003174,
    4.054007291793823
]

total_time = [
    1.0386245250701904,
    0.7921750545501709,
    0.5122437477111816,
    0.5938072204589844,
    0.8484165668487549,
    1.0892021656036377,
    1.2637395858764648,
    1.5795249938964844,
    1.8248567581176758,
    2.067831516265869,
    2.2788901329040527,
    2.518676996231079,
    2.717102289199829,
    2.966787815093994,
    3.132965326309204,
    3.272758960723877,
    3.550140142440796,
    3.6930952072143555,
    3.879102945327759,
    4.112467050552368
]

# Plot
plt.figure(figsize=(8, 5))
plt.plot(m, assembly_time_gpu, marker='o', label='Assembly time (GPU)')
plt.plot(m, solve_time_gpu, marker='o', label='Solve time (GPU)')
plt.plot(m, total_time, marker='o', label='Total time')

plt.xlabel('Number of elements (m)')
plt.ylabel('Time (seconds)')
plt.title('CG-based GPU FEM Timing vs Spatial Resolution')
plt.grid(True)
plt.legend()
plt.tight_layout()
plt.show()
